<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="maximum-scale=1.0,minimum-scale=1.0,user-scalable=0,width=device-width,initial-scale=1.0"/>
	<meta name="format-detection" content="telephone=no,email=no,date=no,address=no">
	<link rel="stylesheet" type="text/css" href="./AUI/css/aui.css" />
	<link rel="stylesheet" type="text/css" href="https://res.wx.qq.com/open/libs/weui/1.1.2/weui.min.css">
	<link href="https://cdn.bootcss.com/jquery-weui/1.0.1/css/jquery-weui.min.css" rel="stylesheet">
	
	<title>服务购买</title>
	
	<script type="text/javascript">
	/*$(document).ready(function(e){
			//setup() ;
	});*/

	</script>

</head>

<style>
	.black{position: relative;}
	.Mask{z-index: 2;position: absolute;width: 100%;height: 100%;background-color: #eee;opacity:0.5}
	.beMask{z-index: 1;position: absolute;}

</style>

<body>
	<section class="aui-content-padded">
	<form name="inform" onchange="changed()" oninput="changed()">
		
		<div class="aui-content aui-margin-b-15">
			<ul class="aui-list aui-from-list" >
				<li class="aui-list-header">填写信息（必填）</li>
				<li class="aui-list-item">
					<div class="aui-list-item-inner">
						<div class="aui-list-item-label">*姓名:</div>
						<div class = "aui-list-item-input">
							<input type="text" placeholder="姓名" name="name" >
						</div>
					</div>
				</li>
				<li class="aui-list-item">
					<div class="aui-list-item-inner">
						<div class="aui-list-item-label">*性别:</div>
						<div class = "aui-list-item-input">
							<label><input class="aui-radio" type="radio" name="sex"  value="男" checked="true">男</label>
							<label><input class="aui-radio" type="radio" name="sex"  value="女">女</label>
							<!--<input type="text" placeholder="男/女" name="sex">-->
						</div>
					</div>
				</li>
				<li class="aui-list-item">
					<div class="aui-list-item-inner">
						<div class="aui-list-item-label">*年龄:</div>
						<div class = "aui-list-item-input">
							<input type="number" placeholder="年龄" name="age" >
						</div>
					</div>
				</li>
				<li class="aui-list-item">
					<div class="aui-list-item-inner">
						<div class="aui-list-item-label">*邮寄地址:</div>
						<div class = "aui-list-item-input">
							<input type="text" name="local" class="weui-input" value="" id="city-picker">
						</div>
					</div>
				</li>
				<li class="aui-list-item">
					<div class="aui-list-item-inner">
						<div class="aui-list-item-label"></div>
						<div class = "aui-list-item-input">
							<input type="text" placeholder="详细地址" name="address" >
						</div>
					</div>
				</li>
				<li class="aui-list-item">
					<div class="aui-list-item-inner">
						<div class="aui-list-item-label">*联系电话:</div>
						<div class = "aui-list-item-input">
							<input type="number" placeholder="电话" name="phone">
						</div>
					</div>
				</li>

				<li class="aui-list-item">
					<div class="aui-list-item-inner">
						<div class="aui-list-item-label">*是否怀孕:</div>
						<div class = "aui-list-item-input">
							<label><input class="aui-radio" type="radio" name="ispregnant" value="是">是</label>
							<label><input class="aui-radio" type="radio" name="ispregnant" value="否" checked="true">否</label>
							
						</div>
					</div>
				</li>
			</ul>
		</div>
		<div class="aui-content aui-margin-b-15">
			<ul class="aui-list aui-from-list" >
				<li class="aui-list-header">其他信息（选题）</li>
				<li class="aui-list-item">
					<div class="aui-list-item-inner">
						<div class="aui-list-item-label">身高:</div>
						<div class = "aui-list-item-input">
							<input type="number" placeholder="身高（cm）" name="tall">
						</div>
					</div>
				</li>
				<li class="aui-list-item">
					<div class="aui-list-item-inner">
						<div class="aui-list-item-label">体重:</div>
						<div class = "aui-list-item-input">
							<input type="number" placeholder="体重（kg）" name="weight">
						</div>
					</div>
				</li>	
			</ul>
		</div>
		<p class=""><input class="aui-checkbox" type="radio" name="isagree" onclick="agreeClick(this)">本项目仅用于XX病早期筛查，所测结果并不代表最终确诊结果。</p>
	</form>
	</section>

	
	<footer class="aui-bar aui-bar-tab">
	<div class="black">
	    <div class="Mask" id="mask" ></div>
	    <div class="beMask aui-btn aui-btn-success aui-bar-tab-item bemask" id="pay" tapmode>支付</div>
	</div>
	</footer>

</body>
<script src="https://code.jquery.com/jquery-3.2.1.min.js"></script>
<script type="text/javascript" src="./AUI/script/aui-dialog.js" ></script>

<script src="https://cdn.bootcss.com/jquery-weui/1.0.1/js/jquery-weui.min.js"></script>
<script src="https://cdn.bootcss.com/jquery-weui/1.0.1/js/city-picker.min.js"></script>
<script type="text/javascript">
	
	//呼出省市选择器
	$("#city-picker").cityPicker({
	  showDistrict: false
	});
	
      

	//启用、禁用按钮
	function changed(){
		console.log("change");
		//阻止input-age内输入e
		$('input[name=age]').val($('input[name=age]').val().replace(/^[e.]$/,''));
		//遍历form的元素值
		var arr = $('form').serializeArray();
		var data = {};
		//变成json格式
		for(var item in arr){
			data[arr[item].name] = arr[item].value;
		}
		console.log(data);
		if(data.name==''||data.name==' '||data.age==''||data.age==' '||data.local==""||data.address==''||data.address==' '||data.phone==''||data.phone==' '||(!data.isagree)){
				document.getElementById('mask').style.display="block";
				console.log("hidden");
		}else{
			document.getElementById('mask').style.display="none";
			console.log("show");
		}

	}


	//radio按钮取消/选定
	var aflag = true;
	function agreeClick(id){
		id.checked =aflag;
		aflag = !aflag;
		changed();
	}

	//点击支付按钮
	$('#pay').click(function(e){
		console.log("click pay");
		//遍历form的元素值
		var dialog = new auiDialog({});
		var arr = $('form').serializeArray();
		var phone = /^[1][3,5,8][0-9]{9}$/;
		var data = {};
		//变成json格式
		for(var item in arr){
			data[arr[item].name] = arr[item].value;
		}
		console.log(data);
		//判断电话是否为手机
		if (!phone.test(data.phone) ) {
			dialog.alert({
				title:"提示",
				msg:'请填写正确的电话号码',
				buttons:['确定']
			});
		}else{			
			dialog.alert({
				title:"提示",
				msg:'确定信息无误并且支付？',
				buttons:['取消','确定'],
				},function(re){
				if (re.buttonIndex==2) {
					console.log("pay");
		      		//打开微信支付链接
	        }});
		}
	})
</script>
</html>


